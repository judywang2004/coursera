define("bundles/seo/components/CourseGoogleSchemaMarkup",["require","exports","module","moment","naptime","react-with-addons","underscore","bundles/naptimejs/resources/courses.v1","bundles/naptimejs/resources/domains.v1","bundles/naptimejs/resources/instructors.v1","bundles/naptimejs/resources/onDemandCourseMaterialModules.v1","bundles/naptimejs/resources/onDemandCourseMaterials.v2","bundles/naptimejs/resources/onDemandSessions.v1","bundles/naptimejs/resources/onDemandSpecializations.v1","bundles/naptimejs/resources/partners.v1","js/app/config","js/lib/imgix","js/lib/path","i18n!nls/seo"],function(require,exports,module){"use strict";function _defaults(e,s){for(var o=Object.getOwnPropertyNames(s),r=0;r<o.length;r++){var n=o[r],t=Object.getOwnPropertyDescriptor(s,n);t&&t.configurable&&void 0===e[n]&&Object.defineProperty(e,n,t)}return e}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _inherits(r,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):_defaults(r,e))}var m=function(){function defineProperties(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(e,r,n){return r&&defineProperties(e.prototype,r),n&&defineProperties(e,n),e}}(),f=function get(o,u,c){var n=!0;e:for(;n;){var r=o,i=u,a=c;n=!1,null===r&&(r=Function.prototype);var e=Object.getOwnPropertyDescriptor(r,i);if(void 0===e){var t=Object.getPrototypeOf(r);if(null===t)return void 0;o=t,u=i,c=a,n=!0,e=t=void 0;continue e}if("value"in e)return e.value;var s=e.get;if(void 0===s)return void 0;return s.call(a)}},t=require("moment"),i=require("naptime"),e=require("react-with-addons"),_=require("underscore"),s=require("bundles/naptimejs/resources/courses.v1"),o=require("bundles/naptimejs/resources/domains.v1"),p=require("bundles/naptimejs/resources/instructors.v1"),l=require("bundles/naptimejs/resources/onDemandCourseMaterialModules.v1"),d=require("bundles/naptimejs/resources/onDemandCourseMaterials.v2"),a=require("bundles/naptimejs/resources/onDemandSessions.v1"),u=require("bundles/naptimejs/resources/onDemandSpecializations.v1"),c=require("bundles/naptimejs/resources/partners.v1"),r=require("js/app/config"),g=require("js/lib/imgix"),n=require("js/lib/path"),y=require("i18n!nls/seo"),v=function(i){function CourseGoogleSchemaMarkup(){_classCallCheck(this,CourseGoogleSchemaMarkup),f(Object.getPrototypeOf(CourseGoogleSchemaMarkup.prototype),"constructor",this).apply(this,arguments)}return _inherits(CourseGoogleSchemaMarkup,i),m(CourseGoogleSchemaMarkup,[{key:"getSchemaOrgBooleanString",value:function getSchemaOrgBooleanString(e){return"http://schema.org/"+(e?"True":"False")}},{key:"getTimeRequired",value:function getTimeRequired(e){var r=_(e).pluck("timeCommitment").reduce(function(e,r){return e+r});return t.duration(r)}},{key:"clearEmptyFields",value:function clearEmptyFields(r){var e=r,n=Object.keys(e);return n.forEach(function(r){e[r]||delete e[r]}),e}},{key:"render",value:function render(){var b=this,o=this.props,s=o.course,p=o.domain,d=o.partner,m=o.currentOpenSessions,a=o.instructor,u=o.modules,l=o.s12n,f=[p?p.name:y("Learning")],i=m&&m[0],c=s.primaryLanguages,h=c&&c.length>0?c[0]:"en",j="launched"===s.courseStatus&&[{"@type":"CourseInstance",startDate:i&&t(i.startedAt).local().format("YYYY-MM-DD"),endDate:i&&t(i.endedAt).local().format("YYYY-MM-DD"),inLanguage:h,instructor:{"@type":"Person",name:a.firstName+" "+a.lastName,"@id":n.join(r.url.base,a.link)}}],O=u&&u.length>0&&this.getTimeRequired(u),S={"@context":"http://schema.org","@type":"Course","@id":n.join(r.url.base,s.link),name:s.name,subjectOfStudy:f,description:s.description,provider:{"@type":"CollegeOrUniversity",name:d.name,url:n.join(r.url.base,d.shortName)},seller:{"@type":"Corporation",name:"Coursera",url:r.url.base},isAccessibleForFree:this.getSchemaOrgBooleanString(!0),hasCourseInstance:j,grantsCredential:this.getSchemaOrgBooleanString(-1!==s.certificates.indexOf("VerifiedCert")),thumbnail:s.photoUrl&&{"@context":"http://schema.org","@type":"ImageObject",contentUrl:g.processImage(s.photoUrl,{fit:"crop",crop:"entropy",width:160,height:160})},timeRequired:O,partOfEducationalTrack:l&&[n.join(r.url.base,l.link)]},v=function createMarkup(){return{__html:'\n        <script type="application/ld+json">\n          '+JSON.stringify(b.clearEmptyFields(S))+"\n        </script>\n      "}};return e.createElement("div",{className:"rc-CourseGoogleSchemaMarkup"},e.createElement("div",{dangerouslySetInnerHTML:v()}))}}],[{key:"propTypes",value:{course:e.PropTypes.instanceOf(s).isRequired,currentOpenSessions:e.PropTypes.arrayOf(e.PropTypes.instanceOf(a)),domain:e.PropTypes.instanceOf(o),instructor:e.PropTypes.instanceOf(p),modules:e.PropTypes.arrayOf(e.PropTypes.instanceOf(l)),partner:e.PropTypes.instanceOf(c),s12n:e.PropTypes.instanceOf(u)},enumerable:!0}]),CourseGoogleSchemaMarkup}(e.Component),b=i.createContainer(v,function(d){var e=d.course,g=d.courseMaterial,n=e.domainTypes,t=e.partnerIds,r=e.instructorIds,s=e.s12nIds,i=g.moduleIds,m=n&&n.length>0&&n[0].domainId,a=t&&t.length>0&&parseInt(t[0],10),f=r&&r.length>0&&parseInt(r[0],10);return{domain:m&&o.get(m)||void 0,partner:a&&c.get(a)||void 0,instructor:f&&p.get(f,{fields:["firstName","lastName","profileId"]})||void 0,s12n:s&&s.length>0&&u.get(s[0])||void 0,modules:i&&i.length>0&&l.multiGet(i,{fields:["timeCommitment"]})||void 0}});module.exports=i.createContainer(function(r){return e.createElement(b,r)},function(e){return{course:s.get(e.courseId,{fields:["slug","name","description","domainTypes","partnerIds","courseStatus","upcomingSessionStartDate","instructorIds","certificates","photoUrl","s12nIds","primaryLanguages"],includes:["instructorIds"]}),currentOpenSessions:a.finder("currentOpenByCourse",{params:{courseId:e.courseId}}),courseMaterial:d.get(e.courseId,{fields:["moduleIds"],includes:["modules"]})}})});